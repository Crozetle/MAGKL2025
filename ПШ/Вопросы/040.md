---
–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
  - –ì–õ–ê–í–ù–´–ô
Direction:
  - "[[–ü–®]]"
Discipline: –û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ
tags:
  - —Å–ª–æ–∂–Ω–æ
  - –≥–æ—Ç–æ–≤–æ
---
[[039.md|<< –ü—Ä–µ–¥—ã–¥—É—â–∏–π –≤–æ–ø—Ä–æ—Å]] | [[041.md|–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å >>]]
## –í–æ–ø—Ä–æ—Å
–°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤. –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏. volatile. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ Object. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ –∫–ª–∞—Å—Å–∞ Object.

### –ß—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å?
–≠—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –∫–∞—Å–∞–µ—Ç—Å—è **–ø—Ä–æ–±–ª–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–º –¥–∞–Ω–Ω—ã–º –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ**. –¢–∞–∫–∂–µ –æ–Ω —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç **–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤ Java –µ—â—ë —Å —Ä–∞–Ω–Ω–∏—Ö –≤–µ—Ä—Å–∏–π (`wait()`, `notify()`, `notifyAll()`), –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º `volatile`.
#### ‚ö†Ô∏è –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏:
- –ù–µ–¥–æ–æ—Ü–µ–Ω–∫–∞ **–ø—Ä–æ–±–ª–µ–º –≥–æ–Ω–∫–∏ (race condition)** –∏ **—Å–æ—Å—Ç–æ—è–Ω–∏–π –≥–æ–Ω–∫–∏**.
- –ü—É—Ç–∞–Ω–∏—Ü–∞ –º–µ–∂–¥—É `volatile` –∏ `synchronized`.
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–ª–∏ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `wait()` / `notify()`.
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–Ω–∏–º–∞–Ω–∏—è **–º–æ–Ω–∏—Ç–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞** –∫–∞–∫ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `wait()` –≤–Ω–µ `synchronized`-–±–ª–æ–∫–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ `IllegalMonitorStateException`.

---
## –û—Ç–≤–µ—Ç
### **2.1 –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤**
- **–°–æ—Å—Ç–æ—è–Ω–∏—è –≥–æ–Ω–∫–∏ (race conditions)** –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –ø–æ–ª—è–º –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤.
- –ü—Ä–∏–º–µ—Ä: –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞ –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ ‚Üí –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è** –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –µ—ë –∑–∞—â–∏—Ç—ã.

```java
static int counter = 0;

public static void main(String[] args) throws InterruptedException {
	Runnable task = () -> {
		for (int i = 0; i < 1000; i++) {
			counter++; // ‚ùó –ù–ï —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
		}
	};

	Thread t1 = new Thread(task);
	Thread t2 = new Thread(task);

	t1.start();
	t2.start();

	t1.join(); // –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
	t2.join();

	System.out.println("–ò—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: " + counter);
}

// –û–∂–∏–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: `2000`
// –†–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: –º–µ–Ω—å—à–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1721, 1935 –∏ —Ç.–ø.)
```

```java
static int counter = 0;

public static void main(String[] args) throws InterruptedException {
	Runnable task = () -> {
		for (int i = 0; i < 1000; i++) {
			synchronized (RaceConditionExample.class) {
			    counter++;
			}
		}
	};

	Thread t1 = new Thread(task);
	Thread t2 = new Thread(task);

	t1.start();
	t2.start();

	t1.join(); // –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
	t2.join();

	System.out.println("–ò—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: " + counter);
}
```

---
### **2.2 –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–º —Ä–µ—Å—É—Ä—Å–∞–º**
| –¢–∏–ø –æ—à–∏–±–∫–∏                                                       | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                   | –°–ø–æ—Å–æ–± —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è                                                                                         |
| ---------------------------------------------------------------- | ------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------- |
| **–ì–æ–Ω–∫–∞ (Race condition)**                                       | –ù–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –æ–±—â–∏–º –¥–∞–Ω–Ω—ã–º, –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –∏–ª–∏ –¥–∞–Ω–Ω—ã–º. | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `synchronized`, –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (`Lock`).                                    |
| **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö**                             | –ü–æ—Ç–æ–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö, —á—Ç–æ –Ω–µ –∑–∞—â–∏—â–∞–µ—Ç –æ–±—â–∏–π —Ä–µ—Å—É—Ä—Å –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.  | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ–¥–Ω–æ–º –æ–±—â–µ–º –º–æ–Ω–∏—Ç–æ—Ä–µ (–æ–±—ä–µ–∫—Ç–µ).                                                       |
| **–í–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (Deadlock)**                               | –ü–æ—Ç–æ–∫–∏ –∂–¥—É—Ç –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞, –≤ –∏—Ç–æ–≥–µ –Ω–∏ –æ–¥–∏–Ω –Ω–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. | –ò–∑–±–µ–≥–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–π–º–∞—É—Ç—ã, —Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞—Ö–≤–∞—Ç–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.                 |
| **–ó–∞–≤–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `wait()`/`notify()`** | –ü–æ—Ç–æ–∫ –Ω–∞–≤—Å–µ–≥–¥–∞ –æ–∂–∏–¥–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç, –∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ç–µ—Ä—è–µ—Ç—Å—è.         | –í—ã–∑—ã–≤–∞—Ç—å `wait()` –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–∞ —Å —É—Å–ª–æ–≤–∏–µ–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `notifyAll()`, –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø. |
#### 1. –ì–æ–Ω–∫–∞ (Race condition)`
```java
class Counter {
    int count = 0;

    public void increment() {
        count++; // –ù–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
    }
}

public class RaceConditionDemo {
    public static void main(String[] args) throws InterruptedException {
        Counter counter = new Counter();

        Runnable task = () -> {
            for (int i = 0; i < 1000; i++) {
                counter.increment();
            }
        };

        Thread t1 = new Thread(task);
        Thread t2 = new Thread(task);
        t1.start();
        t2.start();
        t1.join();
        t2.join();

        System.out.println(counter.count); // –û–∂–∏–¥–∞–µ—Ç—Å—è 2000, –Ω–æ –±—É–¥–µ—Ç –º–µ–Ω—å—à–µ –∏–∑-–∑–∞ –≥–æ–Ω–∫–∏
    }
}
```

**–†–µ—à–µ–Ω–∏–µ:** —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Ç–æ–º–∞—Ä–Ω—ã–π —Ç–∏–ø
```java
public synchronized void increment() {
    count++;
}

// –∏–ª–∏

import java.util.concurrent.atomic.AtomicInteger;

class Counter {
    AtomicInteger count = new AtomicInteger(0);

    public void increment() {
        count.incrementAndGet();
    }
}
```
#### 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö (–Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
```java
class SharedResource {
    private final Object lock1 = new Object();
    private final Object lock2 = new Object();
    int value = 0;

    public void increment() {
        synchronized(lock1) {
            value++;
        }
    }

    public void decrement() {
        synchronized(lock2) {
            value--;
        }
    }
}
```
**–ü—Ä–æ–±–ª–µ–º–∞:** `increment()` –∏ `decrement()` —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö, –≤–æ–∑–º–æ–∂–Ω—ã –≥–æ–Ω–∫–∏ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ `value`.

**–†–µ—à–µ–Ω–∏–µ:** —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ–¥–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ
```java
class SharedResource {
    private final Object lock = new Object();
    int value = 0;

    public void increment() {
        synchronized(lock) {
            value++;
        }
    }

    public void decrement() {
        synchronized(lock) {
            value--;
        }
    }
}
```
#### 3. –í–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (Deadlock)
```java
public class DeadlockDemo {
    private final Object lockA = new Object();
    private final Object lockB = new Object();

    public void method1() {
        synchronized(lockA) {
            System.out.println("Thread 1: Locked lockA");
            try { Thread.sleep(100); } catch (InterruptedException e) {}
            synchronized(lockB) {
                System.out.println("Thread 1: Locked lockB");
            }
        }
    }

    public void method2() {
        synchronized(lockB) {
            System.out.println("Thread 2: Locked lockB");
            try { Thread.sleep(100); } catch (InterruptedException e) {}
            synchronized(lockA) {
                System.out.println("Thread 2: Locked lockA");
            }
        }
    }

    public static void main(String[] args) {
        DeadlockDemo demo = new DeadlockDemo();

        new Thread(demo::method1).start();
        new Thread(demo::method2).start();
    }
}
```
**–ü—Ä–æ–±–ª–µ–º–∞:** `Thread 1` –¥–µ—Ä–∂–∏—Ç `lockA` –∏ –∂–¥—ë—Ç `lockB`, `Thread 2` –¥–µ—Ä–∂–∏—Ç `lockB` –∏ –∂–¥—ë—Ç `lockA` ‚Üí –≤–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞.

**–†–µ—à–µ–Ω–∏–µ:** —Å–æ–±–ª—é–¥–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∑–∞—Ö–≤–∞—Ç–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
```java
public void method1() {
    synchronized(lockA) {
        System.out.println("Thread 1: Locked lockA");
        synchronized(lockB) {
            System.out.println("Thread 1: Locked lockB");
        }
    }
}

public void method2() {
    synchronized(lockA) {  // –¢–µ–ø–µ—Ä—å —Ç–æ—Ç –∂–µ –ø–æ—Ä—è–¥–æ–∫ –∑–∞—Ö–≤–∞—Ç–∞
        System.out.println("Thread 2: Locked lockA");
        synchronized(lockB) {
            System.out.println("Thread 2: Locked lockB");
        }
    }
}
```
#### 4. –ó–∞–≤–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `wait()`/`notify()`
```java
class WaitNotifyDemo {
    private final Object lock = new Object();

    public void waitingThread() throws InterruptedException {
        synchronized(lock) {
            System.out.println("Waiting...");
            lock.wait();  // –ï—Å–ª–∏ notify –Ω–µ –≤—ã–∑–æ–≤—É—Ç, –ø–æ—Ç–æ–∫ –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –≤–µ—á–Ω–æ
            System.out.println("Notified!");
        }
    }

    public void notifyingThread() {
        synchronized(lock) {
            // –ï—Å–ª–∏ –≤—ã–∑–≤–∞—Ç—å notify –¥–æ wait, notify "–ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è"
            lock.notify();
        }
    }
}
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –µ—Å–ª–∏ `notify()` –≤—ã–∑–≤–∞–Ω –¥–æ `wait()`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è –∏ –ø–æ—Ç–æ–∫ –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞.

**–†–µ—à–µ–Ω–∏–µ:** –≤—ã–∑—ã–≤–∞—Ç—å `wait()` –≤ —Ü–∏–∫–ª–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —É—Å–ª–æ–≤–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `notifyAll()`
```java
class WaitNotifyDemo {
    private final Object lock = new Object();
    private volatile boolean condition = false;

    public void waitingThread() throws InterruptedException {
        synchronized(lock) {
            while (!condition) { // —Ü–∏–∫–ª –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ
                lock.wait();
            }
            System.out.println("Condition met, proceeding...");
        }
    }

    public void notifyingThread() {
        synchronized(lock) {
            condition = true;
            lock.notifyAll(); // —É–≤–µ–¥–æ–º–ª—è–µ–º –≤—Å–µ—Ö –æ–∂–∏–¥–∞—é—â–∏—Ö
        }
    }
}
```

---
### **2.3 –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `volatile`**
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç **–≤–∏–¥–∏–º–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏**.
- –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç **–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å** –æ–ø–µ—Ä–∞—Ü–∏–π!
- –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ñ–ª–∞–≥–æ–≤ —Ç–∏–ø–∞ "–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Ç–æ–∫", –Ω–æ **–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–≤, —Å—á—ë—Ç—á–∏–∫–æ–≤ –∏ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö**.

```java
volatile boolean running = true;
```

üìå –ü—Ä–∏–≤–µ—Å—Ç–∏ **–ø—Ä–∏–º–µ—Ä —Å —Ñ–ª–∞–≥–æ–º –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—Ç–æ–∫–∞**, –ø–æ—è—Å–Ω–∏—Ç—å, –ø–æ—á–µ–º—É –±–µ–∑ `volatile` –≤–æ–∑–º–æ–∂–Ω–∞ "–∑–∞–≤–∏—Å—à–∞—è" –ª–æ–≥–∏–∫–∞.

---
### **2.4 –ú–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ `Object`, –ø—Ä–∏–º–µ–Ω–∏–º—ã–µ –∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**
#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:
–ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –≤ Java –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω —Å **–º–æ–Ω–∏—Ç–æ—Ä–æ–º** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏. –ß—Ç–æ–±—ã –≤—ã–∑–≤–∞—Ç—å `wait()`, `notify()`, `notifyAll()`, –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω **–∑–∞—Ö–≤–∞—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞** (`synchronized`).
- `wait()` ‚Äî –ø–æ—Ç–æ–∫ **–æ—Ç–ø—É—Å–∫–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è** (–¥–æ –≤—ã–∑–æ–≤–∞ `notify()` –∏–ª–∏ `notifyAll()`).
- `notify()` ‚Äî –ø—Ä–æ–±—É–∂–¥–∞–µ—Ç **–æ–¥–∏–Ω** –ø–æ—Ç–æ–∫, –æ–∂–∏–¥–∞—é—â–∏–π –Ω–∞ –¥–∞–Ω–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ.
- `notifyAll()` ‚Äî –ø—Ä–æ–±—É–∂–¥–∞–µ—Ç **–≤—Å–µ** –ø–æ—Ç–æ–∫–∏, –æ–∂–∏–¥–∞—é—â–∏–µ –Ω–∞ –¥–∞–Ω–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ.

–ü–æ—Å–ª–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è –ø–æ—Ç–æ–∫ –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É.

üìå –í—Å–µ —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å **—Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞/–º–µ—Ç–æ–¥–∞**:

```java
synchronized(obj) {
    obj.wait();
}
```

#### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
- `synchronized` –±–ª–æ–∫–∏
- –ú–æ–Ω–∏—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞ (`this` –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –æ–±—ä–µ–∫—Ç)

üìå –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ **—Å—Ö–µ–º—É —Ä–∞–±–æ—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∞**: –ø–æ—Ç–æ–∫ ‚Üí –∑–∞—Ö–≤–∞—Ç –º–æ–Ω–∏—Ç–æ—Ä–∞ ‚Üí `wait()` ‚Üí –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ ‚Üí `notify()` ‚Üí –≤–æ–∑–≤—Ä–∞—Ç ‚Üí –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ.

---

### **2.5 –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ—Ç–æ–¥–æ–≤ Object:**

|–ú–µ—Ç–æ–¥|–û–ø–∏—Å–∞–Ω–∏–µ|–£—Å–ª–æ–≤–∏—è|
|---|---|---|
|`wait()`|–û–∂–∏–¥–∞–µ—Ç —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞ —ç—Ç–æ–º –æ–±—ä–µ–∫—Ç–µ|–¢–æ–ª—å–∫–æ –≤ synchronized|
|`notify()`|–°–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ–¥–Ω–æ–º—É –ø–æ—Ç–æ–∫—É, –æ–∂–∏–¥–∞—é—â–µ–º—É –Ω–∞ –æ–±—ä–µ–∫—Ç–µ|–¢–æ–ª—å–∫–æ –≤ synchronized|
|`notifyAll()`|–°–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ–º –æ–∂–∏–¥–∞—é—â–∏–º –ø–æ—Ç–æ–∫–∞–º|–¢–æ–ª—å–∫–æ –≤ synchronized|

```java
class SharedResource {
    private boolean ready = false;

    public synchronized void waitForReady() throws InterruptedException {
        while (!ready) {
            wait(); // –æ—Ç–ø—É—Å–∫–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä –∏ –∂–¥—ë—Ç notify
        }
        System.out.println("–†–µ—Å—É—Ä—Å –≥–æ—Ç–æ–≤, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É");
    }

    public synchronized void setReady() {
        ready = true;
        notify(); // –ø—Ä–æ–±—É–∂–¥–∞–µ–º –æ–¥–∏–Ω –æ–∂–∏–¥–∞—é—â–∏–π –ø–æ—Ç–æ–∫
    }
}

public class Main {
    public static void main(String[] args) {
        SharedResource resource = new SharedResource();

        Thread waitingThread = new Thread(() -> {
            try {
                resource.waitForReady();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });

        waitingThread.start();

        try {
            Thread.sleep(1000); // –∏–º–∏—Ç–∞—Ü–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ä–µ—Å—É—Ä—Å–∞
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        resource.setReady(); // —Å–∏–≥–Ω–∞–ª –ø–æ—Ç–æ–∫—É waitingThread
    }
}
```

---
## –°—Å—ã–ª–∫–∏
